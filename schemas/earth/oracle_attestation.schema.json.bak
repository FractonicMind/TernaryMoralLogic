{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://tml-goukassian.org/schemas/earth/v2.0/oracle_attestation",
  "title": "Oracle Attestation Schema",
  "description": "Structure for oracle network attestations on ecological data validity",
  "type": "object",
  "required": ["attestation_id", "timestamp", "oracle_id", "data_reference", "validation_result"],
  
  "properties": {
    "schema_version": {
      "const": "2.0"
    },
    
    "attestation_id": {
      "type": "string",
      "pattern": "^att_[a-z0-9]{16}$",
      "description": "Unique attestation identifier"
    },
    
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Time of attestation creation"
    },
    
    "oracle_id": {
      "type": "string",
      "pattern": "^oracle_[a-z0-9]{8}$",
      "description": "Identifier of attesting oracle node"
    },
    
    "oracle_metadata": {
      "type": "object",
      "required": ["node_type", "stake_amount", "reputation_score"],
      "properties": {
        "node_type": {
          "type": "string",
          "enum": ["tier_1", "tier_2", "bridge"]
        },
        "stake_amount": {
          "type": "integer",
          "minimum": 0
        },
        "reputation_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "region": {
          "type": "string"
        },
        "specialization": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "treaty_verification",
              "scientific_data",
              "community_validation",
              "satellite_analysis",
              "sensor_networks",
              "traditional_knowledge"
            ]
          }
        },
        "uptime_percentage": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        }
      }
    },
    
    "data_reference": {
      "type": "object",
      "required": ["data_type", "source_id", "data_hash"],
      "properties": {
        "data_type": {
          "type": "string",
          "enum": [
            "treaty_update",
            "scientific_assessment",
            "community_observation",
            "satellite_imagery",
            "sensor_reading",
            "ecological_event"
          ]
        },
        "source_id": {
          "type": "string",
          "description": "ID of data source being validated"
        },
        "data_hash": {
          "type": "string",
          "pattern": "^sha256:[a-f0-9]{64}$"
        },
        "version": {
          "type": "string"
        },
        "timestamp_of_data": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    
    "validation_result": {
      "type": "object",
      "required": ["valid", "confidence", "checks_performed"],
      "properties": {
        "valid": {
          "type": "boolean"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence level in validation"
        },
        "checks_performed": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["check_type", "result"],
            "properties": {
              "check_type": {
                "type": "string",
                "enum": [
                  "signature_verification",
                  "source_authenticity",
                  "timestamp_validity",
                  "cross_reference",
                  "anomaly_detection",
                  "historical_consistency",
                  "witness_verification",
                  "satellite_correlation"
                ]
              },
              "result": {
                "type": "string",
                "enum": ["pass", "fail", "inconclusive"]
              },
              "details": {
                "type": "string"
              }
            }
          }
        },
        "anomalies_detected": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string"
              },
              "severity": {
                "type": "string",
                "enum": ["low", "medium", "high"]
              },
              "description": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    
    "consensus_context": {
      "type": "object",
      "properties": {
        "round_id": {
          "type": "string",
          "description": "Consensus round identifier"
        },
        "total_oracles": {
          "type": "integer",
          "minimum": 1
        },
        "agreeing_oracles": {
          "type": "integer",
          "minimum": 0
        },
        "dissenting_oracles": {
          "type": "integer",
          "minimum": 0
        },
        "consensus_achieved": {
          "type": "boolean"
        },
        "consensus_threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "vrf_proof": {
          "type": "string",
          "description": "VRF proof for oracle selection"
        }
      }
    },
    
    "cross_validation": {
      "type": "object",
      "properties": {
        "satellite_check": {
          "type": "object",
          "properties": {
            "performed": {"type": "boolean"},
            "provider": {"type": "string"},
            "correlation": {"type": "number", "minimum": 0, "maximum": 1},
            "image_hash": {"type": "string"}
          }
        },
        "community_verification": {
          "type": "object",
          "properties": {
            "performed": {"type": "boolean"},
            "witnesses": {"type": "integer"},
            "consensus": {"type": "boolean"},
            "community_ids": {
              "type": "array",
              "items": {"type": "string"}
            }
          }
        },
        "scientific_validation": {
          "type": "object",
          "properties": {
            "performed": {"type": "boolean"},
            "method": {"type": "string"},
            "confidence": {"type": "number"}
          }
        }
      }
    },
    
    "stake_commitment": {
      "type": "object",
      "required": ["amount_staked", "slash_conditions"],
      "properties": {
        "amount_staked": {
          "type": "integer",
          "minimum": 0
        },
        "slash_conditions": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "false_positive",
              "false_negative",
              "collusion",
              "downtime",
              "malicious_behavior"
            ]
          }
        },
        "slashed": {
          "type": "boolean",
          "default": false
        },
        "slash_amount": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    
    "performance_metrics": {
      "type": "object",
      "properties": {
        "validation_time_ms": {
          "type": "integer",
          "minimum": 0
        },
        "cpu_usage_percent": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "memory_usage_mb": {
          "type": "number",
          "minimum": 0
        },
        "network_calls": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    
    "signature": {
      "type": "object",
      "required": ["algorithm", "public_key", "signature_value"],
      "properties": {
        "algorithm": {
          "type": "string",
          "enum": ["Ed25519", "ECDSA-P384", "RSA-4096"]
        },
        "public_key": {
          "type": "string"
        },
        "signature_value": {
          "type": "string"
        },
        "hardware_attestation": {
          "type": "object",
          "properties": {
            "tee_type": {
              "type": "string",
              "enum": ["SGX", "SEV-SNP", "Nitro", "TrustZone"]
            },
            "quote": {
              "type": "string"
            },
            "measurement": {
              "type": "string"
            }
          }
        }
      }
    },
    
    "dispute_status": {
      "type": "object",
      "properties": {
        "disputed": {
          "type": "boolean",
          "default": false
        },
        "dispute_reason": {
          "type": "string"
        },
        "disputing_party": {
          "type": "string"
        },
        "resolution": {
          "type": "string",
          "enum": ["pending", "upheld", "overturned", "inconclusive"]
        },
        "resolution_timestamp": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    
    "economic_details": {
      "type": "object",
      "properties": {
        "reward_earned": {
          "type": "number",
          "minimum": 0
        },
        "gas_consumed": {
          "type": "number",
          "minimum": 0
        },
        "priority_fee": {
          "type": "number",
          "minimum": 0
        }
      }
    },
    
    "metadata": {
      "type": "object",
      "properties": {
        "protocol_version": {
          "type": "string"
        },
        "chain_height": {
          "type": "integer",
          "minimum": 0
        },
        "related_attestations": {
          "type": "array",
          "items": {"type": "string"}
        },
        "tags": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    }
  },
  
  "additionalProperties": false
}
