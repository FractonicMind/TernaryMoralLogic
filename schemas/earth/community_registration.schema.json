{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://tml-goukassian.org/schemas/earth/v2.0/community_registration",
  "title": "Community Registration Schema",
  "description": "Registration structure for Indigenous and local communities as sovereign ecological data stewards",
  "type": "object",
  "required": ["community_id", "name", "governance", "territory", "registration_type"],
  
  "properties": {
    "schema_version": {
      "const": "2.0"
    },
    
    "community_id": {
      "type": "string",
      "pattern": "^com_[a-z0-9]{8}$",
      "description": "Auto-generated unique identifier"
    },
    
    "name": {
      "type": "object",
      "required": ["primary"],
      "properties": {
        "primary": {
          "type": "string",
          "minLength": 1,
          "maxLength": 200
        },
        "indigenous_name": {
          "type": "string",
          "description": "Name in Indigenous language"
        },
        "alternative_names": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    },
    
    "governance": {
      "type": "object",
      "required": ["type", "decision_process", "sovereignty_declaration"],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "consensus_council",
            "elder_council",
            "chief_council",
            "assembly",
            "traditional_custom",
            "hybrid",
            "other"
          ]
        },
        "decision_process": {
          "type": "string",
          "description": "Plain language description of how decisions are made"
        },
        "representatives": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "role": {"type": "string"},
              "name": {"type": "string"},
              "contact_method": {
                "type": "string",
                "enum": ["email", "phone", "sms", "whatsapp", "signal", "in_person", "radio"]
              },
              "term_end": {"type": "string", "format": "date"}
            }
          }
        },
        "quorum_requirements": {
          "type": "object",
          "properties": {
            "minimum_participants": {"type": "integer"},
            "percentage_required": {"type": "number"},
            "special_conditions": {"type": "string"}
          }
        },
        "sovereignty_declaration": {
          "type": "object",
          "required": ["data_ownership", "consent_protocol"],
          "properties": {
            "data_ownership": {
              "type": "string",
              "enum": ["community_collective", "tribal_nation", "indigenous_sovereign", "local_cooperative"]
            },
            "consent_protocol": {
              "type": "string",
              "enum": ["fpic", "consensus", "council_approval", "custom"]
            },
            "ids_principles": {
              "type": "boolean",
              "description": "Adherence to Indigenous Data Sovereignty principles"
            },
            "care_principles": {
              "type": "boolean",
              "description": "Adherence to CARE principles"
            }
          }
        },
        "dispute_resolution": {
          "type": "string",
          "description": "Internal process for resolving conflicts"
        }
      }
    },
    
    "territory": {
      "type": "object",
      "required": ["description"],
      "properties": {
        "description": {
          "type": "string",
          "description": "Plain language description of territory"
        },
        "boundaries": {
          "oneOf": [
            {
              "type": "object",
              "properties": {
                "type": {"const": "geojson"},
                "data": {"type": "object"}
              }
            },
            {
              "type": "object",
              "properties": {
                "type": {"const": "coordinates"},
                "points": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "lat": {"type": "number"},
                      "lng": {"type": "number"}
                    }
                  }
                }
              }
            },
            {
              "type": "object",
              "properties": {
                "type": {"const": "descriptive"},
                "landmarks": {
                  "type": "array",
                  "items": {"type": "string"}
                }
              }
            }
          ]
        },
        "area_km2": {
          "type": "number",
          "minimum": 0
        },
        "ecosystems": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "forest",
              "wetland",
              "grassland",
              "desert",
              "tundra",
              "marine",
              "freshwater",
              "mountain",
              "coastal",
              "arctic",
              "tropical",
              "other"
            ]
          }
        },
        "sacred_sites": {
          "type": "object",
          "properties": {
            "has_sacred_sites": {"type": "boolean"},
            "protection_level": {
              "type": "string",
              "enum": ["public", "restricted", "confidential"]
            }
          }
        }
      }
    },
    
    "registration_type": {
      "type": "string",
      "enum": ["online", "offline", "hybrid"]
    },
    
    "connectivity": {
      "type": "object",
      "required": ["primary_method"],
      "properties": {
        "primary_method": {
          "type": "string",
          "enum": [
            "internet_continuous",
            "internet_periodic",
            "mobile_data",
            "sms_only",
            "satellite",
            "radio",
            "courier",
            "ngo_relay"
          ]
        },
        "backup_methods": {
          "type": "array",
          "items": {"type": "string"}
        },
        "sync_frequency": {
          "type": "string",
          "enum": ["realtime", "daily", "weekly", "monthly", "quarterly"]
        },
        "offline_capability": {
          "type": "object",
          "properties": {
            "storage_method": {
              "type": "string",
              "enum": ["usb_encrypted", "paper_forms", "voice_recording", "local_server"]
            },
            "collection_protocol": {"type": "string"}
          }
        }
      }
    },
    
    "ecological_monitoring": {
      "type": "object",
      "properties": {
        "focus_areas": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "water_quality",
              "deforestation",
              "wildlife_populations",
              "seasonal_patterns",
              "pollution",
              "climate_indicators",
              "soil_health",
              "fire_management",
              "invasive_species",
              "traditional_indicators"
            ]
          }
        },
        "monitoring_capacity": {
          "type": "object",
          "properties": {
            "active_monitors": {"type": "integer"},
            "youth_participants": {"type": "integer"},
            "elder_advisors": {"type": "integer"},
            "technical_equipment": {
              "type": "array",
              "items": {"type": "string"}
            }
          }
        },
        "reporting_capability": {
          "type": "object",
          "properties": {
            "languages": {
              "type": "array",
              "items": {"type": "string"}
            },
            "formats": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["text", "voice", "photo", "video", "traditional_art", "oral_testimony"]
              }
            }
          }
        },
        "traditional_knowledge": {
          "type": "object",
          "properties": {
            "includes_tek": {
              "type": "boolean",
              "description": "Traditional Ecological Knowledge included"
            },
            "knowledge_keepers": {"type": "integer"},
            "transmission_method": {"type": "string"}
          }
        }
      }
    },
    
    "stewardship_participation": {
      "type": "object",
      "required": ["initial_stake", "payment_method"],
      "properties": {
        "initial_stake": {
          "type": "integer",
          "minimum": 0,
          "description": "Initial Proof-of-Stewardship tokens"
        },
        "payment_method": {
          "type": "object",
          "required": ["type"],
          "properties": {
            "type": {
              "type": "string",
              "enum": [
                "mobile_money",
                "bank_transfer",
                "crypto_wallet",
                "ngo_distribution",
                "community_fund",
                "resource_credits"
              ]
            },
            "details": {
              "type": "object",
              "properties": {
                "account_info": {"type": "string"},
                "verification_method": {"type": "string"}
              }
            }
          }
        },
        "grant_eligibility": {
          "type": "object",
          "properties": {
            "micro_grants": {"type": "boolean"},
            "emergency_fund": {"type": "boolean"},
            "infrastructure_support": {"type": "boolean"}
          }
        }
      }
    },
    
    "verification": {
      "type": "object",
      "required": ["registration_date", "verification_method"],
      "properties": {
        "registration_date": {
          "type": "string",
          "format": "date-time"
        },
        "verification_method": {
          "type": "string",
          "enum": [
            "digital_signature",
            "community_attestation",
            "ngo_validation",
            "government_recognition",
            "stewardship_verification"
          ]
        },
        "verifier": {
          "type": "object",
          "properties": {
            "entity": {"type": "string"},
            "contact": {"type": "string"},
            "signature": {"type": "string"}
          }
        },
        "supporting_documents": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {"type": "string"},
              "hash": {"type": "string"},
              "location": {"type": "string"}
            }
          }
        }
      }
    },
    
    "partnerships": {
      "type": "object",
      "properties": {
        "supporting_organizations": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {"type": "string"},
              "type": {
                "type": "string",
                "enum": ["ngo", "university", "government", "foundation", "cooperative"]
              },
              "support_type": {
                "type": "array",
                "items": {
                  "type": "string",
                  "enum": ["technical", "financial", "training", "connectivity", "legal"]
                }
              }
            }
          }
        },
        "neighboring_communities": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "community_id": {"type": "string"},
              "relationship": {
                "type": "string",
                "enum": ["data_sharing", "joint_monitoring", "dispute_resolution", "resource_management"]
              }
            }
          }
        }
      }
    },
    
    "consent_log": {
      "type": "object",
      "properties": {
        "fpic_obtained": {
          "type": "boolean",
          "description": "Free, Prior, and Informed Consent"
        },
        "consent_date": {"type": "string", "format": "date"},
        "renewal_required": {"type": "string", "format": "date"},
        "withdrawal_process": {"type": "string"},
        "data_usage_restrictions": {
          "type": "array",
          "items": {"type": "string"}
        }
      }
    },
    
    "status": {
      "type": "object",
      "required": ["active", "last_activity"],
      "properties": {
        "active": {"type": "boolean"},
        "last_activity": {"type": "string", "format": "date-time"},
        "suspension_reason": {"type": "string"},
        "reactivation_conditions": {"type": "string"}
      }
    },
    
    "metadata": {
      "type": "object",
      "properties": {
        "schema_version": {"type": "string"},
        "last_updated": {"type": "string", "format": "date-time"},
        "update_history": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "date": {"type": "string", "format": "date-time"},
              "changes": {"type": "string"},
              "approved_by": {"type": "string"}
            }
          }
        }
      }
    }
  },
  
  "additionalProperties": false
}
