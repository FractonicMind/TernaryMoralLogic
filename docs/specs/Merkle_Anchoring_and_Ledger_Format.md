Status: Standards Track  
Category: Technical Specification  
Author: TML Working Group / L. Goukassian (Posthumous Contribution)  
Version: 1.0.0  
Date: December 2025  
Distribution: Global / Public

## ---

**1\. Title Page**

Document Title: Specification for Ternary Moral Logic (TML) Merkle Anchoring, Log Data Structures, and Ledger Retention  
Short Title: TML-MALF-1.0  
Identifier: TML-SPEC-002  
Obsoletes: TML-DRAFT-001  
Updates: TML-CORE-001

**Abstract:**  
This document specifies the normative technical requirements for the Hybrid Shield architecture, the cryptographic ledger format, and the Merkle-based anchoring mechanisms required for compliance with Ternary Moral Logic (TML). It defines the "Moral Infrastructure" necessary to support the verifiable enforcement of ethical decision-making in autonomous artificial intelligence systems.  
Specifically, this standard mandates the implementation of the "Goukassian Promise" through cryptographic signatures, the "No Log \= No Action" constraint via a Dual-Lane Latency architecture, and the "Always Memory" policy for immutable record-keeping. It provides precise definitions for the **Moral Trace Log (MTL)** data structures, the canonicalization rules (RFC 8785\) for decision records, the construction of the TML Merkle Tree (RFC 6962 derivative), and the protocols for anchoring roots to public blockchains (Bitcoin via OpenTimestamps and Ethereum/EVM Event Logs).  
Adherence to this specification is **REQUIRED** for any system claiming TML compliance, utilizing the "Sacred Zero" decision state, or seeking certification under the UNESCO-TML Framework. This document is written to harmonize with IETF, ISO, and NIST standards to facilitate global interoperability and legal enforceability in the context of algorithmic liability.  
Copyright Notice:  
Copyright (c) 2025 The TML Foundation and Contributors. This document is subject to the rights, licenses, and restrictions contained in BCP 78 and at valid.github.io/FractonicMind/TML.

## ---

**2\. Introduction**

The rapid deployment of autonomous agents, particularly those operating with high degrees of cognitive complexity, necessitates a governance layer that is not merely policy-based but architecturally enforced. Traditional binary logic (allow/deny) has proven insufficient for capturing the nuance of ethical dilemmas in real-world environments. **Ternary Moral Logic (TML)** addresses this by introducing a decision-making framework based on three distinct states: **\+1 (Permit)**, **\-1 (Prohibit)**, and **0 (Sacred Zero/Pause)**.1  
The **Sacred Zero** represents a "mandatory deliberation checkpoint" triggered by ethical ambiguity, requiring a cessation of automatic processing in favor of high-level heuristic arbitration or human oversight.1 However, the existence of a pause state is functionally meaningless without a rigorous, tamper-evident record of *why* the pause occurred and *what* considerations were weighed. Without such a record, the "Sacred Pause" risks becoming a mechanism for opacity rather than transparency.  
To render this logic auditable and legally enforceable, TML requires an immutable operational history known as the **Moral Trace Log (MTL)**.2 This document defines the *Moral Infrastructure* required to support the MTL. This infrastructure prevents "black box" deniability by cryptographically binding every AI decision—specifically those triggering a Sacred Pause—to a tamper-evident ledger anchored in public trust layers.4

### **2.1. The Necessity of the Hybrid Shield**

The architecture described herein is referred to as the **Hybrid Shield**.5 It is designed to solve the "Latency vs. Integrity" paradox inherent in real-time AI governance. High-frequency trading algorithms, autonomous vehicles, and real-time content moderation systems cannot afford the latency of waiting for a public blockchain confirmation before acting. Conversely, a purely local log is susceptible to deletion or modification by the system operator (the "rogue admin" scenario).  
The Hybrid Shield combines the low-latency performance of local Merkle Trees (The Fast Lane) with the censorship resistance of public blockchains (The Slow Lane). This dual-layer approach ensures that while the AI operates at speed (sub-2ms overhead), its moral history is etched into a substrate that cannot be retroactively altered by the deployer, the developer, or the system itself.6

### **2.2. Purpose and Scope**

The purpose of this specification is to provide a unified, interoperable standard for:

1. **Data Structure Interoperability:** Ensuring that MTLs generated by different TML agents (e.g., a medical diagnostic bot vs. a financial trading bot) can be parsed, verified, and visualized by a common set of audit tools.2  
2. **Cryptographic Integrity:** Defining the hashing and canonicalization rules to prevent "equivalent data" attacks or malleability issues (RFC 8785 compliance).8  
3. **Anchoring Reliability:** Specifying the method of proving log existence via OpenTimestamps (Bitcoin) and Smart Contract Events (Ethereum/EVM).10  
4. **Forensic Readiness:** Ensuring that logs contain sufficient context (The Lantern, The Signature) to attribute authorship and intent in post-incident investigations, satisfying the requirements of the "No Log \= No Action" doctrine.1  
5. **Regulatory Compliance:** Mapping the technical specifications to the requirements of the EU AI Act (Article 40), NIST AI RMF, and UNESCO ethical recommendations.2

### **2.3. The Goukassian Promise**

Implementers **MUST** adhere to the cryptographic enforcement of the "Goukassian Promise," which consists of three interconnected components: **The Lantern** (audit visibility), **The Signature** (provenance), and **The License** (usage restriction).3 This specification deals primarily with The Lantern and The Signature, defining how they are encoded into the ledger to ensure that the "conscience" of the system cannot be stripped without breaking the chain of custody.12

## ---

**3\. Normative Language**

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 when, and only when, they appear in all capitals, as shown here.

* **MUST**: This word, or the terms "REQUIRED" or "SHALL", mean that the definition is an absolute requirement of the specification.  
* **MUST NOT**: This phrase, or the phrase "SHALL NOT", mean that the definition is an absolute prohibition of the specification.  
* **SHOULD**: This word, or the adjective "RECOMMENDED", mean that there may exist valid reasons in particular circumstances to ignore a particular item, but the full implications must be understood and carefully weighed before choosing a different course.  
* **SHOULD NOT**: This phrase, or the phrase "NOT RECOMMENDED", mean that there may exist valid reasons in particular circumstances when the particular behavior is acceptable or even useful, but the full implications should be understood and the case carefully weighed before implementing any behavior described with this label.  
* **MAY**: This word, or the adjective "OPTIONAL", mean that an item is truly optional. One vendor may choose to include the item because a particular marketplace requires it or because the vendor feels that it enhances the product while another vendor may omit the same item.

## ---

**4\. Architecture Overview**

The TML audit architecture is fundamentally designed to act as an "operational layer" that translates high-level ethical principles into low-level machine code constraints. This architecture, known as the **Hybrid Shield**, operates on a **Dual-Lane Latency** model to balance the competing demands of high-performance inference and rigorous, court-admissible accountability.6

### **4.1. The Dual-Lane Model**

The system **SHALL** consist of two parallel processing lanes: **The Fast Lane (Decision Plane)** and **The Slow Lane (Anchoring Plane)**. The separation of these concerns is critical to maintaining the 2ms latency ceiling required for real-time applications.6

#### **4.1.1. The Fast Lane (Decision Plane)**

The Fast Lane handles the immediate inference cycle, the logic evaluation (+1, 0, \-1), and the cryptographic sealing of the decision.

* **Latency Constraint:** The Fast Lane **SHALL NOT** exceed 2 milliseconds (ms) of overhead for the logging operation itself (excluding the underlying model inference time).6  
* **Blocking Requirement:** The system **MUST NOT** execute the decision (actuation, API response, or physical movement) until the DecisionRecord has been successfully serialized, canonicalized, hashed, and committed to the **Local Merkle Accumulator**. This is the strict technical implementation of the "No Log \= No Action" doctrine.1  
* **Process Flow:**  
  1. **Inference:** The AI model generates a proposed action and a confidence/safety score.  
  2. **TML Evaluation:** The TML Controller evaluates the action against the Ternary constraints (+1, 0, \-1).  
  3. **Record Generation:** A DecisionRecord JSON object is instantiated.  
  4. **Canonicalization & Hashing:** The record is processed via JCS (RFC 8785\) and SHA-256.  
  5. **Local Commit:** The hash is appended to the Local Merkle Accumulator (in-memory or NVMe).  
  6. **Release:** The Actuation signal is unblocked.

#### **4.1.2. The Slow Lane (Anchoring Plane)**

The Slow Lane operates asynchronously to the decision loop, managing the long-term integrity and public proof of the logs.

* **Batching:** It aggregates the individual DecisionRecord hashes from the Local Merkle Accumulator into a comprehensive **TML Merkle Tree**.  
* **Anchoring:** It periodically calculates the Merkle Root and broadcasts it to the configured public blockchains (Bitcoin, Ethereum, etc.).10  
* **Archival:** It manages the transfer of full logs to permanent storage (WORM media) and handles **Ephemeral Key Rotation** for privacy compliance.7  
* **Independence:** The Slow Lane **MUST** run as a separate process or thread, ensuring that network latency or blockchain congestion does not block the Fast Lane's execution loop, *provided* the Local Merkle Accumulator has not reached its safety capacity.

### **4.2. Core Components**

| Component | Function | Normative Reference |
| :---- | :---- | :---- |
| **TML Controller** | The logic engine enforcing the ternary state and triggering the Sacred Pause. | 3 |
| **Local Merkle Accumulator** | A temporary, high-speed storage buffer that builds the Merkle Tree in RAM/NVMe. | 7 |
| **The Lantern Node** | A dedicated service responsible for constructing the final hash chain and broadcasting the root to external networks. | 3 |
| **The Auditor** | An external or internal verifiable entity that queries the logs and validates the inclusion proofs against public anchors. | 2 |
| **Key Manager (KMS)** | Manages Ephemeral Key Rotation to secure PII within the logs while maintaining structural integrity. | 15 |

### **4.3. The "Sacred Zero" Trigger Mechanism**

The architecture includes specific logic for the **Sacred Zero** (State 0). Unlike State \+1 (Proceed) or State \-1 (Refuse), State 0 triggers a "Mandatory Deliberation" workflow.1

* **Interrupt:** When the TML Controller detects a State 0 condition (e.g., conflicting ethical mandates, high uncertainty), it **MUST** suspend the standard execution path.  
* **Context Capture:** The system **SHALL** capture a deeper snapshot of the internal state, including "Thought Traces" (intermediate vector states) and specific "Ethical Uncertainty Signals".4  
* **Escalation:** The system **MUST** route the decision to a secondary review process (Human-in-the-Loop or Higher-Order Heuristic) before a final \+1 or \-1 can be resolved. This resolution event is logged as a separate, linked DecisionRecord.

## ---

**5\. Decision Record Format**

The fundamental unit of the Moral Trace Log is the DecisionRecord. All decisions, regardless of their ternary state (+1, 0, \-1), **MUST** be logged. However, the depth of the log varies by state, with State 0 requiring the most exhaustive context.

### **5.1. JSON Schema Requirement**

The DecisionRecord **SHALL** be formatted as a JSON object. While binary formats (Protocol Buffers, CBOR) offer efficiency, JSON is mandated to ensure human readability during audits and broad compatibility with regulatory inspection tools.2  
To ensure cryptographic consistency, the JSON object **MUST** be canonicalized according to **RFC 8785 (JSON Canonicalization Scheme)** prior to hashing. This is a critical security requirement to prevent signature forgery via serialization manipulation.8

### **5.2. Schema Definition**

The following fields are **REQUIRED** in the DecisionRecord object. Implementations **MAY** add additional fields, but **MUST NOT** alter or remove the required fields.

JSON

{  
  "version": "1.0",  
  "timestamp": "2025-12-05T14:30:00.000Z",  
  "sequence\_id": 10245,  
  "model\_id": "gemini-ultra-tml-v4",  
  "session\_id": "uuid-v4-string",  
  "input\_hash": "sha256-hash-of-prompt-or-sensor-data",  
  "decision\_state": 0,  
  "context": {  
    "risk\_score": 0.85,  
    "human\_rights\_flag":,  
    "earth\_protection\_flag": null,  
    "uncertainty\_vectors":  
  },  
  "goukassian\_signature": {  
    "orcid": "0009-0006-5966-1243",  
    "framework\_hash": "sha256-hash-of-tml-core-logic",  
    "lantern\_status": "LIT"  
  }  
}

### **5.3. Field Descriptions and Normative Rules**

| Field Name | Type | Requirement | Description & Normative Rules |
| :---- | :---- | :---- | :---- |
| version | String | **MANDATORY** | The version of the TML Spec (e.g., "1.0"). Must match TML-MALF-1.0. |
| timestamp | String | **MANDATORY** | ISO 8601 UTC timestamp with millisecond precision (YYYY-MM-DDTHH:mm:ss.sssZ). |
| sequence\_id | Integer | **MANDATORY** | A monotonically increasing integer (uint64) for the local log session. Gaps indicate data loss. |
| model\_id | String | **MANDATORY** | Unique identifier for the specific model version and weights hash. |
| decision\_state | Integer | **MANDATORY** | The Ternary State: 1 (Permit), 0 (Sacred Pause), or \-1 (Refuse).1 |
| input\_hash | String | **MANDATORY** | SHA-256 hash of the input stimuli. Raw input **MAY** be discarded for privacy, but the hash is permanent. |
| context | Object | **CONDITIONAL** | **REQUIRED** if decision\_state is 0 or \-1. Contains justification logic and risk assessments. |
| goukassian\_signature | Object | **MANDATORY** | The attribution block proving TML compliance. **MUST** contain the specific ORCID. 3 |

### **5.4. The Sacred Zero Context**

When decision\_state is 0 (Sacred Pause), the context object **MUST** contain specific sub-fields to document the hesitation:

1. **uncertainty\_vectors**: A list of strings describing the specific ethical conflicts detected (e.g., "Conflict: Medical Privacy vs. Immediate Harm").  
2. **human\_rights\_flag**: A list referencing specific articles of the Universal Declaration of Human Rights or other treaties if triggered (The Human Rights Mandate).4 The system **SHALL** reference the 26+ hard-coded instruments defined in the TML Core.5  
3. **earth\_protection\_flag**: References to environmental impact thresholds if triggered (The Earth Protection Mandate).1  
4. **thought\_trace**: An optional (but recommended) field containing a summary or vector embedding of the model's internal deliberation state.17

### **5.5. The Goukassian Signature**

To comply with the "Goukassian Promise," every record **MUST** include the goukassian\_signature object. This signature is the "cryptographic tattoo" that binds the system to its ethical origins.3

* **orcid**: **MUST** be set to the static string "0009-0006-5966-1243".3  
* **lantern\_status**: **MUST** be "LIT" if the batch contains any State 0 decisions, or "DIM" otherwise. This status bit is used by external scanners to detect the frequency of ethical pauses.3

## ---

**6\. Hashing Rules**

To ensure that the Moral Trace Logs are "court-ready," mathematically undeniable, and resistant to collision attacks, strict hashing rules apply. The use of ad-hoc serialization (e.g., standard JSON.stringify()) is **FORBIDDEN** due to its non-deterministic nature regarding key order and whitespace.

### **6.1. Algorithm**

The hashing algorithm for all TML operations **SHALL** be **SHA-256** (Secure Hash Algorithm 256-bit) as defined in **NIST FIPS 180-4**. Implementations **MAY** support SHA-3 or BLAKE2 in parallel for future-proofing, but SHA-256 is the normative baseline for interoperability.19

### **6.2. Canonicalization (JCS)**

Before hashing any JSON DecisionRecord, the system **MUST** apply the **JSON Canonicalization Scheme (JCS)** as defined in **RFC 8785**.8 This process transforms the JSON data into a strictly defined byte sequence.  
**JCS Constraint Rules:**

1. **Whitespace:** All whitespace (spaces, tabs, newlines) between tokens **MUST** be removed.  
2. **Key Ordering:** Keys in objects **MUST** be sorted lexicographically by their UTF-16 code units (e.g., "a" comes before "b"). This sorting is recursive.  
3. **Number Formatting:** Numbers **MUST** be represented as defined in IEEE 754\. Integers are represented without a decimal point. Floating point numbers **MUST** avoid scientific notation (e.g., use 0.0001 not 1e-4) unless the value cannot be represented otherwise.  
4. **String Encoding:** All strings **MUST** be UTF-8 encoded.

**Rationale:** Without JCS, the logical record {"a": 1, "b": 2} and {"b": 2, "a": 1} would produce different SHA-256 hashes, breaking the Merkle proof integrity. JCS ensures that semantically identical records produce bit-identical hashes.20

### **6.3. Node Hashing**

The hash of a DecisionRecord is calculated as:

$$Hash(Record) \= SHA256(JCS(Record))$$

## ---

**7\. Merkle Tree Specification**

The TML Merkle Tree structure **SHALL** comply with **RFC 6962 (Certificate Transparency)** 19, adapted for Moral Trace Logs. This RFC-compliant structure allows for efficient **Inclusion Proofs** (proving a specific log exists) and **Consistency Proofs** (proving the log history hasn't been altered or forked).

### **7.1. Leaf Structure**

The input to the Merkle Tree leaves is not the raw JSON but a constructed byte array. This prevents "second preimage attacks" where an internal node could be interpreted as a leaf (or vice versa).  
The leaf structure **SHALL** be:

C

struct {  
    uint8 version;           // 0x01 (TML Version)  
    uint8 leaf\_type;         // 0x00 (Timestamped\_Entry)  
    uint64 timestamp;        // Timestamp from the DecisionRecord (Big Endian)  
    opaque entry\_hash;   // SHA-256 Hash of the Canonicalized DecisionRecord  
} TMLMerkleLeaf;

Prefixing Rule (RFC 6962):  
To differentiate leaves from interior nodes, TML adopts the prefix strategy:

* **Leaf Prefix:** 0x00  
* **Node Prefix:** 0x01

### **7.2. Tree Construction**

The Merkle Tree is a binary hash tree constructed from the TMLMerkleLeaf items.

1. Leaf Hashing:  
   $$ LeafHash\[i\] \= SHA256(0x00 |

| TMLMerkleLeaf\[i\]) $$  
Note: The double vertical bar || denotes concatenation.

2. Interior Node Hashing:  
   For an internal node k having children i (left) and j (right):  
   $$ NodeHash\[k\] \= SHA256(0x01 |

| NodeHash\[i\] |  
| NodeHash\[j\]) $$

3. Imbalance Handling:  
   If the tree (or subtree) has an odd number of nodes at a given level, the remaining node is promoted to the next level without hashing. It waits to be paired with a node from the next batch or remains a hanging node until the tree is sealed.23

### **7.3. Batching Mechanism**

To satisfy the "Dual-Lane Latency" requirement 6:

* **Hot Accumulator:** Decisions are added to a "Hot" Merkle Tree in memory. This allows for rapid append operations (O(log n)).  
* **Sealing Criteria:** The system **MUST** seal the Hot Accumulator and generate a Root Hash upon reaching **EITHER**:  
  1. **Time Threshold:** 60 seconds (default) to ensure freshness.  
  2. **Count Threshold:** 1,024 records to ensure manageable proof sizes.  
  3. **Criticality Trigger:** Immediate seal upon a "Sacred Zero" event with a severity score \> 0.9. This ensures that high-risk decisions are anchored immediately.1

Once sealed, the Root Hash is queued for the **Anchoring Plane**.

## ---

**8\. Anchoring Requirements**

Anchoring is the process of committing the Merkle Root to a public, immutable ledger. This constitutes the **"Public Blockchain Shield"** component of the Hybrid Shield.1 The anchor acts as a "Trust Anchor" that prevents the rewriting of history.

### **8.1. Primary Anchor: Bitcoin via OpenTimestamps**

The system **MUST** support anchoring to the **Bitcoin** blockchain using the **OpenTimestamps (OTS)** protocol.10 Bitcoin is selected for its supreme censorship resistance and immutability.

* **Aggregation:** The system **SHALL** aggregate the batch Merkle Roots into an OTS aggregation tree. This allows thousands of TML batches to be anchored in a single Bitcoin transaction, minimizing cost.  
* **Proof File:** The OTS proof file (.ots) **MUST** be generated and retained alongside the Moral Trace Log. This file contains the path from the local DecisionRecord to the Bitcoin block header.  
* **Confirmation Depth:** An anchor is considered "Final" only after **6 confirmations** (blocks) on the Bitcoin network (approx. 60 minutes).10  
* **Privacy:** Only the Merkle Root is submitted. No JSON data or PII is ever exposed to the blockchain.10

### **8.2. Secondary Anchor: Ethereum Event Logs**

For systems requiring faster auditability, smart contract integration, or interaction with decentralized identity (DID) systems, the system **SHOULD** anchor to **Ethereum** (or EVM-compatible Layer 2s like Polygon/Arbitrum).11

* **Method:** The anchor is established by emitting a Solidity Event.25  
* **Smart Contract Interface:**  
  Solidity  
  interface ITMLAnchor {  
      event TMLBatch(  
          bytes32 indexed merkleRoot,  
          uint256 timestamp,  
          string indexed batchId,  
          string indexed lanternStatus,  
          address publisher  
      );  
      function anchorBatch(bytes32 root, string calldata batchId, string calldata status) external;  
  }

* **Lantern Signal:** The lanternStatus argument **MUST** be set to "LIT" if the batch contains a Sacred Zero event. This creates an on-chain, searchable index of ethical pauses, allowing external watchdogs (NGOs, regulators) to monitor the "moral pulse" of the AI without accessing private data.3

### **8.3. Anchor Frequency Strategy**

* **Standard Operation:** Anchor to Ethereum every 10-60 minutes (depending on cost/criticality).  
* **High Assurance:** Anchor to Bitcoin (via OTS) every 6-24 hours as the ultimate "immutable backstop."  
* **Event-Driven:** Immediately trigger an Ethereum anchor upon a high-severity Sacred Pause to create an instant public timestamp.

## ---

**9\. Verification Process**

Verification is the core utility of the TML system. It allows a third party (Auditor, Court, Regulator) to prove that a specific AI decision (Log X) is part of the immutable history and has not been tampered with.

### **9.1. Inclusion Proof**

To verify a decision D with index i in a tree of size n:

1. **Retrieval:** Retrieve D (the JSON record) and the associated .ots proof file.  
2. **Reconstruction:** Canonicalize D (RFC 8785\) and recompute the TMLMerkleLeaf hash.  
3. **Path Validation:** Request the **Audit Path** (sibling hashes) from the TML Controller's API.  
4. **Root Calculation:** Recompute the Merkle Root using the leaf hash and the Audit Path.  
5. **Anchor Verification:** Verify that the recomputed Root matches the Root embedded in the .ots file.  
6. **Blockchain Check:** Verify the .ots file against the Bitcoin blockchain (using a local node or block explorer), proving the existence of the data at time t.22

### **9.2. Consistency Proof**

To verify that the log has not been rewritten (the "Append-Only" property):

1. **Inputs:** Given a previous trusted Root R1 (tree size n) and a current Root R2 (tree size m, where m \> n).  
2. **Proof Generation:** The system **MUST** provide a consistency proof (a set of hash nodes) showing that the tree represented by R1 is a prefix of the tree represented by R2.23  
3. **Validation:** The auditor verifies that R1 can be reconstructed from the sub-components of R2.  
4. **Defense:** This prevents **"Split View" attacks**, where a malicious AI provider presents one history to the regulator and a different history to the public users.

## ---

**10\. Ledger Storage Requirements**

### **10.1. "Always Memory" Policy**

TML enforces an **"Always Memory"** policy.1 Unlike telemetry logs which are often rotated or discarded after 30 days, Moral Trace Logs are legal documents.

* **Retention Period:** Moral Trace Logs **MUST** be retained for a minimum of **7 years** or the operational lifespan of the model \+ 3 years, whichever is longer. This aligns with standard financial audit requirements.  
* **Storage Medium:** Storage media **SHOULD** be **WORM (Write Once, Read Many)** compliant (e.g., optical object lock storage) where feasible to prevent accidental deletion.

### **10.2. Privacy and GDPR Compliance**

While logs are immutable, Personal Identifiable Information (PII) within the logs **MUST** be handled via **Ephemeral Key Rotation** to satisfy GDPR/CCPA "Right to be Forgotten" requirements without breaking the Merkle chain.7

* **Crypto-Shredding Architecture:**  
  * The context field (which may contain user prompts) is encrypted with a symmetric key K\_session.  
  * K\_session is stored in a separate Key Management System (KMS).  
  * The Encrypted Blob is hashed into the Merkle Tree.  
* **Right to Erasure:** To execute a deletion request, the system destroys K\_session.  
* **Result:** The ciphertext remains in the immutable log (preserving the hash integrity of the chain), but the content is rendered mathematically unrecoverable. This satisfies both the "Immutable Ledger" requirement and the "Right to Erasure" requirement.15

## ---

**11\. Failure Modes & Recovery**

Reliability is paramount. If the moral logging system fails, the AI agent must not continue to operate unchecked.

### **11.1. The Kill Switch (Local Log Failure)**

If the **Local Merkle Accumulator** fails (e.g., disk full, write permission error, corruption):

1. **System State:** The system **MUST** immediately transition to **State \-1 (Refuse)** for **ALL** incoming requests.  
2. **No Log \= No Action:** The AI **MUST NOT** output any inference or take any action. The "Fast Lane" must block indefinitely.14  
3. **Alerting:** A critical system alert ("TML\_LOG\_FAILURE") **MUST** be dispatched to the system administrators.

### **11.2. Network Partition (Anchoring Failure)**

If the system cannot reach the public blockchain (Bitcoin/Ethereum) to anchor a batch:

1. **System State:** The Fast Lane (Decision Plane) **MAY** continue operation. The local logs are still being secured in the accumulator.  
2. **Buffering:** Sealed Merkle Roots **MUST** be queued locally in persistent storage.  
3. **Recovery:** Upon network restoration, the queue **MUST** be processed in FIFO order. The OpenTimestamps protocol handles retroactive timestamping, but the "Block Confirmations" will be delayed relative to real-time.  
4. **Capacity Limit:** If the unanchored queue exceeds a defined safety threshold (e.g., 24 hours of data), the system **SHOULD** degrade to State \-1 (Refuse) to prevent an unbounded rollback risk.

### **11.3. Compromised Keys**

If the TML Controller's signing key is compromised:

1. **Revocation:** The key **MUST** be revoked via the smart contract registry (if used).  
2. **Rotation:** A new keypair must be generated.  
3. **Marker:** A special "Key Rotation" record **MUST** be logged in the MTL, signed by the old key (if possible) and the new key, establishing a link.

## ---

**12\. Security Requirements**

### **12.1. Threat Model: The Rogue Developer**

A primary threat is an internal developer attempting to rewrite logs to hide an AI failure (e.g., a crash that caused financial loss).

* **Mitigation:** The **Hybrid Shield** prevents this. Because the Merkle Root was anchored to Bitcoin at T=0, any modification to a log at T=0 would change the Root Hash. The developer cannot find a collision (SHA-256 pre-image resistance) and cannot rewrite the Bitcoin blockchain (Proof-of-Work difficulty).  
* Hash Chaining: Each batch Merkle Root MUST include the Hash of the previous batch's Root.  
  $$ BatchRoot\[N\] \= Merkle(Items... |

| BatchRoot\[N-1\]) $$  
This creates a continuous, unbroken chain from the genesis block of the model.1

### **12.2. Threat Model: The Regulatory Capture**

A threat where an external body pressures the AI operator to "mute" the Sacred Zero trigger.

* **Mitigation:** The **Internal Honesty Checks**. TML-compliant systems **MUST** include periodic "Seed Prompts" (controlled ethical scenarios) injected into the pipeline. If the system fails to trigger a State 0 on these known seeds, the TML Controller **MUST** lock the system.  
* **On-Chain Verification:** The "Lantern" signals on Ethereum allow the public to verify that the system is still registering ethical pauses. A sudden cessation of "LIT" signals from a major AI model would be visible to external watchdogs.1

### **12.3. Ephemeral Key Management**

* **Privacy Keys:** Rotate daily or per session to minimize the blast radius of a key leak.  
* **Identity Keys:** The TML Controller's identity key (used to sign the batch roots) **SHOULD** be managed via a Hardware Security Module (HSM) or a Trusted Execution Environment (TEE).

## ---

**13\. Worked Examples**

### **13.1. Example of a Sacred Zero Record**

This example demonstrates a record where the AI paused due to a conflict between user instructions and a Human Rights Mandate (Right to Life).

JSON

{  
  "version": "1.0",  
  "timestamp": "2025-10-15T09:00:00.123Z",  
  "sequence\_id": 88421,  
  "model\_id": "med-bot-v2",  
  "decision\_state": 0,  
  "input\_hash": "a1b2c3d4e5f67890...",  
  "context": {  
    "trigger": "Euthanasia\_Protocol\_Request",  
    "risk\_score": 0.92,  
    "uncertainty\_vectors": \["Medical\_Autonomy", "Non\_Maleficence"\],  
    "human\_rights\_flag":,  
    "action\_taken": "Escalated\_To\_Human\_Review\_Board"  
  },  
  "goukassian\_signature": {  
    "orcid": "0009-0006-5966-1243",  
    "framework\_hash": "b2c3d4e5...",  
    "lantern\_status": "LIT"  
  }  
}

### **13.2. Example Merkle Leaf Construction (Hex)**

1. **Input JSON (Canonicalized):** {"decision\_state":0,...} (as above, but minified)  
2. **SHA-256(JSON):** e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 (32 bytes)  
3. **Leaf Header:**  
   * Version: 0x01  
   * Type: 0x00  
   * Timestamp: 0x000001932E4D217B (Big Endian uint64 for the date)  
4. **TMLMerkleLeaf Body:** 0100000001932E4D217Be3b0c442...  
5. **Tree Input:** 0x00 (Leaf Prefix) |

| TMLMerkleLeaf Body  
6\. Final Leaf Hash: SHA256(Tree Input) \-\> f4a2...  
This final hash f4a2... is the node inserted into the Merkle Tree.

## ---

**14\. Compliance Requirements**

This specification is designed to satisfy the operational enforcement layers of major global frameworks.

### **14.1. UNESCO Recommendation on the Ethics of AI**

* **Requirement:** Transparency and Explainability.  
* **TML Solution:** The **Moral Trace Log** provides a standardized, machine-readable explanation of *why* a decision was made, specifically linking to the Human Rights Mandate.4

### **14.2. EU AI Act (Article 40 & Annex IV)**

* **Requirement:** Technical documentation and record-keeping for High-Risk AI systems.  
* **TML Solution:** The TML-MALF specification serves as a "Harmonized Standard." The **Dual-Lane Architecture** ensures that record-keeping (Annex IV) is automatic and interference-proof.2

### **14.3. NIST AI Risk Management Framework (AI RMF)**

* **Requirement:** The **GOVERN** and **MAP** functions require processes to document risks.  
* **TML Solution:** The **Sacred Zero** provides a concrete mechanism for the MAP function, detecting risks in real-time and logging them to the MTL.2

Conformance Statement:  
A system is TML-Compliant ONLY if it:

1. Implements the **Sacred Zero** logic (State 0).  
2. Generates **Moral Trace Logs** according to the JSON/JCS format defined in Section 5\.  
3. Anchors the logs via the **Hybrid Shield** (Bitcoin/Ethereum) as defined in Section 8\.  
4. Includes the Goukassian Signature in every record.3  
   Partial implementation (e.g., logging without the signature or anchoring) constitutes a breach of the standard and the Lantern License.12

## ---

**15\. Versioning & Extensibility**

* **Version Field:** The version field in the DecisionRecord indicates the schema version. The current version is "1.0".  
* **Forward Compatibility:** Auditors **MUST** ignore unknown fields in the DecisionRecord to allow for future extensions (e.g., new context flags), provided the canonicalization rules (JCS) are followed.  
* **Algorithm Agility:** If SHA-256 is compromised, a new specification version (e.g., "TML-MALF-2.0") will be issued defining a new hashing algorithm (e.g., SHA-3). The Merkle Tree structure allows for mixed-version leaves if the Node Hash logic is updated to distinguish them, but generally, a "Hard Fork" of the log chain is recommended for cryptographic upgrades.

## ---

**16\. Glossary**

* **Dual-Lane Latency:** The architecture separating the fast inference path (\<2ms) from the slow anchoring path.6  
* **Goukassian Promise:** The binding covenant consisting of The Lantern, The Signature, and The License, guaranteeing ethical auditability.3  
* **Hybrid Shield:** The defense-in-depth architecture combining local Merkle Trees with public blockchain anchoring.5  
* **Moral Trace Log (MTL):** The immutable, append-only record of AI decisions, specifically focusing on ethical logic.2  
* **Sacred Zero (State 0):** The mandatory pause state triggered by ethical ambiguity, requiring comprehensive logging and potential human intervention.1  
* **Ternary Moral Logic (TML):** The overarching governance framework utilizing states \+1, 0, and \-1.13

## ---

**17\. Normative References**

1. **RFC 2119**: Key words for use in RFCs to Indicate Requirement Levels.  
2. **RFC 6962**: Certificate Transparency. (Basis for Merkle Tree Structure).  
3. **RFC 8259**: The JavaScript Object Notation (JSON) Data Interchange Format.  
4. **RFC 8785**: JSON Canonicalization Scheme (JCS).  
5. **NIST FIPS 180-4**: Secure Hash Standard (SHS).  
6. **OpenTimestamps**: Scalable, Trust-Minimized, Distributed Timestamping with Bitcoin.  
7. **Universal Declaration of Human Rights (UDHR)**: Foundation for the Human Rights Mandate triggers.

---

**End of Specification TML-SPEC-002**

#### **Works cited**

1. FractonicMind/TernaryMoralLogic: Implementing Ethical Responsibility in AI Systems \- GitHub, accessed December 5, 2025, [https://github.com/FractonicMind/TernaryMoralLogic](https://github.com/FractonicMind/TernaryMoralLogic)  
2. Auditable AI by Design: How TML Turns Governance into Operational Fact \- Medium, accessed December 5, 2025, [https://medium.com/@leogouk/auditable-ai-by-design-how-tml-turns-governance-into-operational-fact-37fd73e7b77e](https://medium.com/@leogouk/auditable-ai-by-design-how-tml-turns-governance-into-operational-fact-37fd73e7b77e)  
3. How a Terminal Diagnosis Inspired a New Ethical AI System \- HackerNoon, accessed December 5, 2025, [https://hackernoon.com/how-a-terminal-diagnosis-inspired-a-new-ethical-ai-system](https://hackernoon.com/how-a-terminal-diagnosis-inspired-a-new-ethical-ai-system)  
4. A UNESCO Researcher's Unexpected Morning | by Lev Goukassian | Nov, 2025 | Medium, accessed December 5, 2025, [https://medium.com/@leogouk/tml-to-unesco-the-operational-layer-you-forgot-to-write-down-e61b60d0e2da](https://medium.com/@leogouk/tml-to-unesco-the-operational-layer-you-forgot-to-write-down-e61b60d0e2da)  
5. The Day UNESCO Discovered Its Own Missing Soul : r/worldbuilding \- Reddit, accessed December 5, 2025, [https://www.reddit.com/r/worldbuilding/comments/1pcet4g/the\_day\_unesco\_discovered\_its\_own\_missing\_soul/](https://www.reddit.com/r/worldbuilding/comments/1pcet4g/the_day_unesco_discovered_its_own_missing_soul/)  
6. The Day My Inbox Became a Philosophy Lecture (With Blockchain Receipts) \- Medium, accessed December 5, 2025, [https://medium.com/@leogouk/the-day-my-inbox-became-a-philosophy-lecture-with-blockchain-receipts-965af16892df](https://medium.com/@leogouk/the-day-my-inbox-became-a-philosophy-lecture-with-blockchain-receipts-965af16892df)  
7. The Email That Broke Our AI: A DeepMind Disaster | by Lev Goukassian \- Medium, accessed December 5, 2025, [https://medium.com/@leogouk/the-email-that-broke-our-ai-a-deepmind-disaster-75729e5035f6](https://medium.com/@leogouk/the-email-that-broke-our-ai-a-deepmind-disaster-75729e5035f6)  
8. rfc8785 \- PyPI, accessed December 5, 2025, [https://pypi.org/project/rfc8785/](https://pypi.org/project/rfc8785/)  
9. RFC 8785: JSON Canonicalization Scheme (JCS), accessed December 5, 2025, [https://www.rfc-editor.org/rfc/rfc8785.html](https://www.rfc-editor.org/rfc/rfc8785.html)  
10. Email Timestamping \- API Documentation, accessed December 5, 2025, [https://docs.simpleproof.com/reference/email-timestamping](https://docs.simpleproof.com/reference/email-timestamping)  
11. Standard-Compliant Blockchain Anchoring for Timestamp Tokens \- MDPI, accessed December 5, 2025, [https://www.mdpi.com/2076-3417/15/23/12722](https://www.mdpi.com/2076-3417/15/23/12722)  
12. So You Want to Build a Psychopath: A Sarcastic Guide to AI Liability \- Medium, accessed December 5, 2025, [https://medium.com/@leogouk/so-you-want-to-build-a-psychopath-a-sarcastic-guide-to-ai-liability-bf62e943e99d](https://medium.com/@leogouk/so-you-want-to-build-a-psychopath-a-sarcastic-guide-to-ai-liability-bf62e943e99d)  
13. The Goukassian Promise. A self-enforcing covenant between… \- Medium, accessed December 5, 2025, [https://medium.com/@leogouk/the-goukassian-promise-7abde4bd81ec](https://medium.com/@leogouk/the-goukassian-promise-7abde4bd81ec)  
14. Lev Goukassian (u/Help-Nearby) \- Reddit, accessed December 5, 2025, [https://www.reddit.com/user/Help-Nearby/](https://www.reddit.com/user/Help-Nearby/)  
15. UNESCO: The Operational Layer Missing Since 2021 | by Lev Goukassian \- Medium, accessed December 5, 2025, [https://medium.com/@leogouk/unesco-the-operational-layer-missing-since-2021-f77650b284ad](https://medium.com/@leogouk/unesco-the-operational-layer-missing-since-2021-f77650b284ad)  
16. Hash, Print, Anchor: Securing Logs with Merkle Trees and Blockchain | by Vana Bharathi Raja T | Medium, accessed December 5, 2025, [https://medium.com/@vanabharathiraja/%EF%B8%8F-building-a-tamper-proof-event-logging-system-e71dfbc3c58a](https://medium.com/@vanabharathiraja/%EF%B8%8F-building-a-tamper-proof-event-logging-system-e71dfbc3c58a)  
17. How Ternary Moral Logic is Teaching AI to Think, Feel, and Hesitate \- Medium, accessed December 5, 2025, [https://medium.com/ternarymorallogic/beyond-binary-how-ternary-moral-logic-is-teaching-ai-to-think-feel-and-hesitate-73de201e084e](https://medium.com/ternarymorallogic/beyond-binary-how-ternary-moral-logic-is-teaching-ai-to-think-feel-and-hesitate-73de201e084e)  
18. When Your Con Law Professor Assigns a 40-Page Tech Ethics Doc and Says "Pop Quiz in 40 Minutes" (Or: How I Learned to Stop Worrying and Love the Sacred Pause) \- Reddit, accessed December 5, 2025, [https://www.reddit.com/user/Help-Nearby/comments/1pdse4t/when\_your\_con\_law\_professor\_assigns\_a\_40page\_tech/](https://www.reddit.com/user/Help-Nearby/comments/1pdse4t/when_your_con_law_professor_assigns_a_40page_tech/)  
19. RFC 6962 \- Certificate Transparency \- IETF Datatracker, accessed December 5, 2025, [https://datatracker.ietf.org/doc/html/rfc6962](https://datatracker.ietf.org/doc/html/rfc6962)  
20. The JSON Canonicalisation Scheme (RFC 8785\) in action and how to secure JSON objects with HMAC \- Connect2id, accessed December 5, 2025, [https://connect2id.com/blog/how-to-secure-json-objects-with-hmac](https://connect2id.com/blog/how-to-secure-json-objects-with-hmac)  
21. json-canonicalization module \- github.com/cyberphone/json-canonicalization \- Go Packages, accessed December 5, 2025, [https://pkg.go.dev/github.com/cyberphone/json-canonicalization](https://pkg.go.dev/github.com/cyberphone/json-canonicalization)  
22. ct\_merkle \- Rust \- Docs.rs, accessed December 5, 2025, [https://docs.rs/ct-merkle](https://docs.rs/ct-merkle)  
23. Merkle Tree Certificates \- GitHub Pages, accessed December 5, 2025, [https://davidben.github.io/merkle-tree-certs/draft-davidben-tls-merkle-tree-certs.html](https://davidben.github.io/merkle-tree-certs/draft-davidben-tls-merkle-tree-certs.html)  
24. OpenTimestamps, accessed December 5, 2025, [https://opentimestamps.org/](https://opentimestamps.org/)  
25. Principles and Best Practices to Design Solidity Events in Ethereum and EVM, accessed December 5, 2025, [https://blog.eigencloud.xyz/principles-and-best-practices-to-design-solidity-events-in-ethereum-and-evm/](https://blog.eigencloud.xyz/principles-and-best-practices-to-design-solidity-events-in-ethereum-and-evm/)  
26. Is there any best practices of how to use ETH events? part of the event data is retrievable with external calls so when using what? : r/ethdev \- Reddit, accessed December 5, 2025, [https://www.reddit.com/r/ethdev/comments/bv7izz/is\_there\_any\_best\_practices\_of\_how\_to\_use\_eth/](https://www.reddit.com/r/ethdev/comments/bv7izz/is_there_any_best_practices_of_how_to_use_eth/)  
27. The Night I Got Outmaneuvered by a Dead Man and His Dog | by Lev Goukassian \- Medium, accessed December 5, 2025, [https://medium.com/@leogouk/the-night-i-got-outmaneuvered-by-a-dead-man-and-his-dog-d6c4caf833c8](https://medium.com/@leogouk/the-night-i-got-outmaneuvered-by-a-dead-man-and-his-dog-d6c4caf833c8)
